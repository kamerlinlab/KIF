
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../stat_modelling/">
      
      
        <link rel="next" href="../network_analysis/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Machine Learning - KIF - Key Interactions Finder</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#key_interactions_finder.model_building" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KIF - Key Interactions Finder" class="md-header__button md-logo" aria-label="KIF - Key Interactions Finder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KIF - Key Interactions Finder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Machine Learning
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/kamerlinlab/kif" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    kamerlinlab/kif
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KIF - Key Interactions Finder" class="md-nav__button md-logo" aria-label="KIF - Key Interactions Finder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    KIF - Key Interactions Finder
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kamerlinlab/kif" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    kamerlinlab/kif
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Get Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Interactions Finder (KIF)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contact_identification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Identification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_preperation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Preperation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stat_modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical Modelling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Machine Learning
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building" class="md-nav__link">
    <span class="md-ellipsis">
      model_building
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.ClassificationModel" class="md-nav__link">
    <span class="md-ellipsis">
      ClassificationModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClassificationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.ClassificationModel.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.ClassificationModel.evaluate_models" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.ClassificationModel.generate_confusion_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      generate_confusion_matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.RegressionModel" class="md-nav__link">
    <span class="md-ellipsis">
      RegressionModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RegressionModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.RegressionModel.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.RegressionModel.evaluate_models" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.UnsupervisedModel" class="md-nav__link">
    <span class="md-ellipsis">
      UnsupervisedModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UnsupervisedModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.UnsupervisedModel.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.UnsupervisedModel.build_models" class="md-nav__link">
    <span class="md-ellipsis">
      build_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key_interactions_finder.model_building.UnsupervisedModel.describe_ml_planned" class="md-nav__link">
    <span class="md-ellipsis">
      describe_ml_planned
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pymol_projections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pymol Projections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chimerax_projections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ChimeraX Projections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project_structure_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Structure Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pycontact_processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PyContact Processing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Machine Learning</h1>

<div class="doc doc-object doc-module">



<a id="key_interactions_finder.model_building"></a>
    <div class="doc doc-contents first">

        <p>Module to prepare and run machine learning (ML) in either a supervised or unsupervised fashion.</p>
<p>3 Classes for end user usage:</p>
<ol>
<li>
<p>ClassificationModel
    For building ML models with categorical target data (classification).</p>
</li>
<li>
<p>RegressionModel
    For building ML models with continious target data (regression).</p>
</li>
<li>
<p>UnsupervisedModel
    For building ML models for datasets without labels.
    Limited support for this module at present.</p>
</li>
</ol>
<p>These classes inherit first from an abstract base class called "_MachineLearnModel".
which sets a basic outline for all 3 classes above.</p>
<p>Classes 1 and 2 then inherit from a parent class called "_SupervisedRunner" which abstracts
as much as their shared behaviour as possible.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="key_interactions_finder.model_building.ClassificationModel" class="doc doc-heading">
            <code>ClassificationModel</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="key_interactions_finder.model_building._SupervisedRunner">_SupervisedRunner</span></code></p>


        <p>Class to construct supervised machine learning models when the target class
is categorical (aka classification).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.dataset">dataset</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.classes_to_use">classes_to_use</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the classes to train the model on.
Can be left empty if you want to use all the classes you currently have.
Default = [] (use all classes in the Target column.)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.models_to_use">models_to_use</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of machine learning models/algorithims to use.
Default = ["CatBoost"]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.evaluation_split_ratio">evaluation_split_ratio</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of data that should be used to make the evaluation test set.
The rest of the data will be used for the training/hyper-param tuning.
Default = 0.15</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.scaling_method">scaling_method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to scale the dataset prior to machine learning.
Options are "min_max" (scikit-learn's MinMaxScaler)
or "standard_scaling" (scikit-learn's StandardScaler).
Default = "min_max"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.out_dir">out_dir</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path to store results files to.
Default = ""</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.cross_validation_splits">cross_validation_splits</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of splits in the cross validation, (the "k" in k-fold cross validation).
Default = 5</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.cross_validation_repeats">cross_validation_repeats</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of repeats for the k-fold cross validation to perform.
Default = 3</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.search_approach">search_approach</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Define how extensive the grid search protocol should be for the models.
Options are: "none", "quick", "moderate", "exhaustive" or "custom".
Default = "quick"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.use_class_weights">use_class_weights</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Choose to weight each class according to the number of observations.
(This can be used in the case of an imbalanced dataset.)
The weights that will be used are the inverse of the class distribution so
each class has effective weight 1 at the end.
Default = False</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.all_model_params">all_model_params</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested dictionary of model parameters that can be read directly into
Scikit-learn's implementation of grid search cv.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.cross_validation_approach">cross_validation_approach</span></code></td>
            <td>
                  <code><span title="sklearn.model_selection.RepeatedStratifiedKFold">RepeatedStratifiedKFold</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of scikit-learn's RepeatedStratifiedKFold class for model building.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.feat_names">feat_names</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All feature names/labels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.ml_datasets">ml_datasets</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested dictionary containing the training and testing data (both features and
classes) needed to run the model building.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.label_encoder">label_encoder</span></code></td>
            <td>
                  <code><span title="sklearn.preprocessing.LabelEncoder">LabelEncoder</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of sci-kit learn's label encoder to encode the target classes.
Required for the XGBoost model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.ClassificationModel.ml_models">ml_models</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keys are the model name/method and values are the instance of the
built model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><span title="key_interactions_finder.model_building.ClassificationModel.describe_ml_planned">describe_ml_planned</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Prints a summary of what machine learning protocol has been selected.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="key_interactions_finder.model_building.ClassificationModel.build_models">build_models</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Runs the machine learning and summarizes the results.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="evaluate_models() (key_interactions_finder.model_building.ClassificationModel.evaluate_models)" href="#key_interactions_finder.model_building.ClassificationModel.evaluate_models">evaluate_models</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Evaluates each ML model's performance on the validation data set
and provides the user with a summary of the results.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="generate_confusion_matrix() (key_interactions_finder.model_building.ClassificationModel.generate_confusion_matrix)" href="#key_interactions_finder.model_building.ClassificationModel.generate_confusion_matrix">generate_confusion_matrix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>For each ml model used, determine the confusion matrix from the validation dataset.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="k">class</span><span class="w"> </span><span class="nc">ClassificationModel</span><span class="p">(</span><span class="n">_SupervisedRunner</span><span class="p">):</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    Class to construct supervised machine learning models when the target class</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    is categorical (aka classification).</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    dataset : pd.DataFrame</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        Input dataset.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    classes_to_use : list</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        Names of the classes to train the model on.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        Can be left empty if you want to use all the classes you currently have.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        Default = [] (use all classes in the Target column.)</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    models_to_use : list</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        List of machine learning models/algorithims to use.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Default = [&quot;CatBoost&quot;]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    evaluation_split_ratio : float</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        Ratio of data that should be used to make the evaluation test set.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        The rest of the data will be used for the training/hyper-param tuning.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Default = 0.15</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    scaling_method : str</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        How to scale the dataset prior to machine learning.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        Options are &quot;min_max&quot; (scikit-learn&#39;s MinMaxScaler)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        or &quot;standard_scaling&quot; (scikit-learn&#39;s StandardScaler).</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Default = &quot;min_max&quot;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    out_dir : str</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        Directory path to store results files to.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        Default = &quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    cross_validation_splits : int</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        Number of splits in the cross validation, (the &quot;k&quot; in k-fold cross validation).</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        Default = 5</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    cross_validation_repeats : int</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        Number of repeats for the k-fold cross validation to perform.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        Default = 3</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    search_approach : str</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        Define how extensive the grid search protocol should be for the models.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        Options are: &quot;none&quot;, &quot;quick&quot;, &quot;moderate&quot;, &quot;exhaustive&quot; or &quot;custom&quot;.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        Default = &quot;quick&quot;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    use_class_weights : bool</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        Choose to weight each class according to the number of observations.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        (This can be used in the case of an imbalanced dataset.)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        The weights that will be used are the inverse of the class distribution so</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        each class has effective weight 1 at the end.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        Default = False</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    all_model_params : dict</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        Nested dictionary of model parameters that can be read directly into</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        Scikit-learn&#39;s implementation of grid search cv.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">    cross_validation_approach : RepeatedStratifiedKFold</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        Instance of scikit-learn&#39;s RepeatedStratifiedKFold class for model building.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    feat_names : np.ndarray</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        All feature names/labels.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    ml_datasets : dict</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        Nested dictionary containing the training and testing data (both features and</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        classes) needed to run the model building.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    label_encoder : LabelEncoder</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        Instance of sci-kit learn&#39;s label encoder to encode the target classes.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Required for the XGBoost model.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    ml_models : dict</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        Keys are the model name/method and values are the instance of the</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        built model.</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    Methods</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    -------</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    describe_ml_planned()</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        Prints a summary of what machine learning protocol has been selected.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    build_models(save_models)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        Runs the machine learning and summarizes the results.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    evaluate_models()</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        and provides the user with a summary of the results.</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    generate_confusion_matrix()</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        For each ml model used, determine the confusion matrix from the validation dataset.</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="c1"># Only non-shared parameters between classificaiton and regression.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="n">label_encoder</span><span class="p">:</span> <span class="n">LabelEncoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="n">classes_to_use</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">use_class_weights</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="c1"># not populated till build_models method called later.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="c1"># Filter to only include desired classes.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_to_use</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_to_use</span><span class="p">)]</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="c1"># Train-test splitting and scaling.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="n">df_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">x_array</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="c1"># label encode the target - for XGBOOST compatability.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">y_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_eval</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">x_array</span><span class="p">,</span> <span class="n">y_classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_split_ratio</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="n">train_data_scaled</span><span class="p">,</span> <span class="n">eval_data_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supervised_scale_features</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="n">scaling_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_method</span><span class="p">,</span> <span class="n">x_array_train</span><span class="o">=</span><span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="o">=</span><span class="n">x_array_eval</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;train_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data_scaled</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_data_scaled</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_eval</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_class_weights</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="c1"># For CatBoostClassifier</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">compute_class_weight</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="n">class_weights</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="c1"># For XGBClassifier, I need the total number of examples in the majority class</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="c1"># divided by the total number of examples in the minority class.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="n">majority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="n">minority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="n">scaled_weight</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">majority</span> <span class="o">/</span> <span class="n">minority</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                <span class="s2">&quot;CatBoost&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">CatBoostClassifier</span><span class="p">(</span><span class="n">class_weights</span><span class="o">=</span><span class="n">class_weights</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="s2">&quot;Silent&quot;</span><span class="p">),</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                <span class="p">},</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">eval_metric</span><span class="o">=</span><span class="s2">&quot;logloss&quot;</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="n">scaled_weight</span><span class="p">),</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                <span class="p">},</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                <span class="s2">&quot;Random_Forest&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="p">}</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class weights have now been added to your dataset.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The class imbalance in your dataset was: 1 : </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">scaled_weight</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="s2">&quot;CatBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">CatBoostClassifier</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s2">&quot;Silent&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">eval_metric</span><span class="o">=</span><span class="s2">&quot;logloss&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                <span class="s2">&quot;Random_Forest&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="p">}</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="c1"># Define ML Pipeline:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_approach</span> <span class="o">=</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">(</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_splits</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_repeats</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="p">)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_model_params</span><span class="p">(</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="n">models_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">models_to_use</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">available_models</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">search_approach</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_approach</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="n">is_classification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        and provides the user with a summary of the results.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        dict</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">            A dictionary with keys being the model names and values being a pd.DataFrame</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">            with several scoring metrics output for each model used.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="c1"># https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="c1"># yhat_decoded = self.label_encoder.inverse_transform(yhat)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">y_eval_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">])</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">class_labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_eval_decoded</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">all_classification_reports</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="n">yhat_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="n">report</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_eval_decoded</span><span class="p">,</span> <span class="n">yhat_decoded</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="c1"># now reformat report so dataframe friendly.</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="n">new_report</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">class_labels</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="n">label</span><span class="p">]})</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="n">accuracy_row</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                <span class="s2">&quot;f1-score&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>                <span class="s2">&quot;support&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">][</span><span class="s2">&quot;support&quot;</span><span class="p">],</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="p">}</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>            <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy_row</span><span class="p">})</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;macro avg&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;macro avg&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="n">df_classification_report</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_report</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">all_classification_reports</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">model_name</span><span class="p">:</span> <span class="n">df_classification_report</span><span class="p">})</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Returning classification reports for each model inside a single dictionary&quot;</span><span class="p">)</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="k">return</span> <span class="n">all_classification_reports</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        For each ml model used, determine the confusion matrix from the validation data set.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        Returns a dictionary with model names as keys and the corresponding matrix as the values.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        dict</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            Keys are strings of each model name. Values are the confusion matrix</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            of said model as a numpy.ndarray.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">yhat_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="n">y_true_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">confuse_matrix</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_decoded</span><span class="p">,</span> <span class="n">yhat_decoded</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="n">confusion_matrices</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">model_name</span><span class="p">:</span> <span class="n">confuse_matrix</span><span class="p">})</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="k">return</span> <span class="n">confusion_matrices</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.ClassificationModel.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setup the provided dataset and params for ML.</p>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="c1"># not populated till build_models method called later.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="c1"># Filter to only include desired classes.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_to_use</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_to_use</span><span class="p">)]</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="c1"># Train-test splitting and scaling.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="n">df_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">x_array</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="c1"># label encode the target - for XGBOOST compatability.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="n">y_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_eval</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">x_array</span><span class="p">,</span> <span class="n">y_classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_split_ratio</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="n">train_data_scaled</span><span class="p">,</span> <span class="n">eval_data_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supervised_scale_features</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="n">scaling_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_method</span><span class="p">,</span> <span class="n">x_array_train</span><span class="o">=</span><span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="o">=</span><span class="n">x_array_eval</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;train_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data_scaled</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_data_scaled</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_eval</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_class_weights</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="c1"># For CatBoostClassifier</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">compute_class_weight</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="n">class_weights</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="c1"># For XGBClassifier, I need the total number of examples in the majority class</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="c1"># divided by the total number of examples in the minority class.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">majority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">minority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">scaled_weight</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">majority</span> <span class="o">/</span> <span class="n">minority</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="s2">&quot;CatBoost&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">CatBoostClassifier</span><span class="p">(</span><span class="n">class_weights</span><span class="o">=</span><span class="n">class_weights</span><span class="p">,</span> <span class="n">logging_level</span><span class="o">=</span><span class="s2">&quot;Silent&quot;</span><span class="p">),</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="p">},</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">eval_metric</span><span class="o">=</span><span class="s2">&quot;logloss&quot;</span><span class="p">,</span> <span class="n">scale_pos_weight</span><span class="o">=</span><span class="n">scaled_weight</span><span class="p">),</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{},</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="p">},</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="s2">&quot;Random_Forest&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s2">&quot;balanced&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="p">}</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class weights have now been added to your dataset.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The class imbalance in your dataset was: 1 : </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">scaled_weight</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="s2">&quot;CatBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">CatBoostClassifier</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s2">&quot;Silent&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">eval_metric</span><span class="o">=</span><span class="s2">&quot;logloss&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="s2">&quot;Random_Forest&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="p">}</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="c1"># Define ML Pipeline:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_approach</span> <span class="o">=</span> <span class="n">RepeatedStratifiedKFold</span><span class="p">(</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_splits</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_repeats</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="p">)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_model_params</span><span class="p">(</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">models_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">models_to_use</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="n">available_models</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="n">search_approach</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_approach</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">is_classification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.ClassificationModel.evaluate_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_models</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluates each ML model's performance on the validation data set
and provides the user with a summary of the results.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with keys being the model names and values being a pd.DataFrame
with several scoring metrics output for each model used.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    and provides the user with a summary of the results.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    dict</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        A dictionary with keys being the model names and values being a pd.DataFrame</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        with several scoring metrics output for each model used.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="c1"># https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="c1"># yhat_decoded = self.label_encoder.inverse_transform(yhat)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="n">y_eval_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">])</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="n">class_labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_eval_decoded</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">all_classification_reports</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">yhat_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">report</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_eval_decoded</span><span class="p">,</span> <span class="n">yhat_decoded</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="c1"># now reformat report so dataframe friendly.</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">new_report</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">class_labels</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="n">label</span><span class="p">]})</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">accuracy_row</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>            <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="s2">&quot;f1-score&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="s2">&quot;support&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">][</span><span class="s2">&quot;support&quot;</span><span class="p">],</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="p">}</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy_row</span><span class="p">})</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;macro avg&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;macro avg&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="n">new_report</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">:</span> <span class="n">report</span><span class="p">[</span><span class="s2">&quot;weighted avg&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">df_classification_report</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_report</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">all_classification_reports</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">model_name</span><span class="p">:</span> <span class="n">df_classification_report</span><span class="p">})</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Returning classification reports for each model inside a single dictionary&quot;</span><span class="p">)</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">return</span> <span class="n">all_classification_reports</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.ClassificationModel.generate_confusion_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_confusion_matrix</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>For each ml model used, determine the confusion matrix from the validation data set.
Returns a dictionary with model names as keys and the corresponding matrix as the values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keys are strings of each model name. Values are the confusion matrix
of said model as a numpy.ndarray.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    For each ml model used, determine the confusion matrix from the validation data set.</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    Returns a dictionary with model names as keys and the corresponding matrix as the values.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">    dict</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        Keys are strings of each model name. Values are the confusion matrix</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        of said model as a numpy.ndarray.</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">confusion_matrices</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="n">yhat_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">y_true_decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="n">confuse_matrix</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_decoded</span><span class="p">,</span> <span class="n">yhat_decoded</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="n">confusion_matrices</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">model_name</span><span class="p">:</span> <span class="n">confuse_matrix</span><span class="p">})</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="k">return</span> <span class="n">confusion_matrices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="key_interactions_finder.model_building.RegressionModel" class="doc doc-heading">
            <code>RegressionModel</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="key_interactions_finder.model_building._SupervisedRunner">_SupervisedRunner</span></code></p>


        <p>Class to construct supervised machine learning models when the target class
is contionous (aka regression).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.dataset">dataset</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.models_to_use">models_to_use</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of machine learning models/algorithims to use.
Default = ["CatBoost"]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.evaluation_split_ratio">evaluation_split_ratio</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ratio of data that should be used to make the evaluation test set.
The rest of the data will be used for the training/hyper-param tuning.
Default = 0.15</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.scaling_method">scaling_method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to scale the dataset prior to machine learning.
Options are "min_max" (scikit-learn's MinMaxScaler)
or "standard_scaling" (scikit-learn's StandardScaler).
Default = "min_max"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.out_dir">out_dir</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path to store results files to.
Default = ""</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.cross_validation_splits">cross_validation_splits</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of splits in the cross validation, (the "k" in k-fold cross validation).
Default = 5</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.cross_validation_repeats">cross_validation_repeats</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of repeats for the k-fold cross validation to perform.
Default = 3</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.search_approach">search_approach</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Define how extensive the grid search protocol should be for the models.
Options are: "none", "quick", "moderate", "exhaustive" or "custom".
Default = "quick"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.all_model_params">all_model_params</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested dictionary of model parameters that can be read directly into
Scikit-learn's implementation of grid search cv.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.cross_validation_approach">cross_validation_approach</span></code></td>
            <td>
                  <code><span title="sklearn.model_selection.RepeatedStratifiedKFold">RepeatedStratifiedKFold</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance of scikit-learn's RepeatedStratifiedKFold class for model building.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.feat_names">feat_names</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All feature names/labels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.ml_datasets">ml_datasets</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested dictionary containing the training and testing data (both features and
classes) needed to run the model building.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.RegressionModel.ml_models">ml_models</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keys are the model name/method and values are the instance of the
built model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><span title="key_interactions_finder.model_building.RegressionModel.describe_ml_planned">describe_ml_planned</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Prints a summary of what machine learning protocol has been selected.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><span title="key_interactions_finder.model_building.RegressionModel.build_models">build_models</span></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Runs the machine learning and summarizes the results.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="evaluate_models() (key_interactions_finder.model_building.RegressionModel.evaluate_models)" href="#key_interactions_finder.model_building.RegressionModel.evaluate_models">evaluate_models</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Evaluates each ML model's performance on the validation data set
and provides the user with a summary of the results.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="k">class</span><span class="w"> </span><span class="nc">RegressionModel</span><span class="p">(</span><span class="n">_SupervisedRunner</span><span class="p">):</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    Class to construct supervised machine learning models when the target class</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    is contionous (aka regression).</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    dataset : pd.DataFrame</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">        Input dataset.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">    models_to_use : list</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        List of machine learning models/algorithims to use.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        Default = [&quot;CatBoost&quot;]</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    evaluation_split_ratio : float</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        Ratio of data that should be used to make the evaluation test set.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        The rest of the data will be used for the training/hyper-param tuning.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        Default = 0.15</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    scaling_method : str</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        How to scale the dataset prior to machine learning.</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        Options are &quot;min_max&quot; (scikit-learn&#39;s MinMaxScaler)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        or &quot;standard_scaling&quot; (scikit-learn&#39;s StandardScaler).</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        Default = &quot;min_max&quot;</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">    out_dir : str</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">        Directory path to store results files to.</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        Default = &quot;&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">    cross_validation_splits : int</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        Number of splits in the cross validation, (the &quot;k&quot; in k-fold cross validation).</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        Default = 5</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">    cross_validation_repeats : int</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">        Number of repeats for the k-fold cross validation to perform.</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">        Default = 3</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">    search_approach : str</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        Define how extensive the grid search protocol should be for the models.</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="sd">        Options are: &quot;none&quot;, &quot;quick&quot;, &quot;moderate&quot;, &quot;exhaustive&quot; or &quot;custom&quot;.</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        Default = &quot;quick&quot;</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">    all_model_params : dict</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">        Nested dictionary of model parameters that can be read directly into</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">        Scikit-learn&#39;s implementation of grid search cv.</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">    cross_validation_approach : RepeatedStratifiedKFold</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">        Instance of scikit-learn&#39;s RepeatedStratifiedKFold class for model building.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    feat_names : np.ndarray</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">        All feature names/labels.</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">    ml_datasets : dict</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        Nested dictionary containing the training and testing data (both features and</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        classes) needed to run the model building.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    ml_models : dict</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        Keys are the model name/method and values are the instance of the</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        built model.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">    Methods</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">    -------</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    describe_ml_planned()</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        Prints a summary of what machine learning protocol has been selected.</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">    build_models(save_models)</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        Runs the machine learning and summarizes the results.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">    evaluate_models()</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">        Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">        and provides the user with a summary of the results.</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="n">available_models</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="s2">&quot;CatBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">CatBoostRegressor</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="s2">&quot;Silent&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="s2">&quot;XGBoost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s2">&quot;reg:squarederror&quot;</span><span class="p">),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="s2">&quot;Random_Forest&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">RandomForestRegressor</span><span class="p">(),</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{}},</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="p">}</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="c1"># This is called at the end of the dataclass&#39;s initialization procedure.</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="c1"># These are all not populated till a method is called later.</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="c1"># Train-test splitting and scaling.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">df_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="n">x_array</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="n">y_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_eval</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">x_array</span><span class="p">,</span> <span class="n">y_classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_split_ratio</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>        <span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="n">train_data_scaled</span><span class="p">,</span> <span class="n">eval_data_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supervised_scale_features</span><span class="p">(</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="n">scaling_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_method</span><span class="p">,</span> <span class="n">x_array_train</span><span class="o">=</span><span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="o">=</span><span class="n">x_array_eval</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="p">)</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;train_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data_scaled</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_data_scaled</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_eval</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="c1"># Define ML Pipeline:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_approach</span> <span class="o">=</span> <span class="n">RepeatedKFold</span><span class="p">(</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_splits</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_repeats</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="p">)</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_model_params</span><span class="p">(</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="n">models_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">models_to_use</span><span class="p">,</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="n">available_models</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">,</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">search_approach</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_approach</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">is_classification</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        and provides the user with a summary of the results.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        pd.DataFrame</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">            Dataframe with each row a containing several regression metrics</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">            for each ML model generated.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">all_regression_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>            <span class="n">y_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="n">regression_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression_metrics</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">y_true</span><span class="o">=</span><span class="n">y_validation</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>            <span class="n">all_regression_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">regression_df</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_regression_dfs</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_regression_metrics</span><span class="p">(</span><span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        Calculate several regression statistics for a given ml model.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        Adapted from:</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        https://stackoverflow.com/questions/26319259/how-to-get-a-regression-summary-in-scikit-learn-like-r-does</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">        model_name : str</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            Name of the ML model.</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        y_true : np.ndarray</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            1D array of the actual values of the target label.</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        y_pred: np.ndarray</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            1D array of the predicted values of the target label.</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        pd.DataFrame</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            Contains various regression metrics for the provided model.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>        <span class="n">explained_variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">explained_variance_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>        <span class="n">mean_absolute_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="n">r_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="n">mean_squared_log_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_log_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Mean Squared Log Error cannot be calculated as your target column contains</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="s2">                  negative numbers. Continuing with the other metrics.&quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="n">mean_squared_log_error</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="n">all_metrics</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="p">[</span><span class="n">model_name</span><span class="p">,</span> <span class="n">explained_variance</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">mean_squared_log_error</span><span class="p">,</span> <span class="n">r_squared</span><span class="p">]</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>        <span class="p">]</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">column_labels</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="s2">&quot;Model&quot;</span><span class="p">,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>            <span class="s2">&quot;Explained Variance&quot;</span><span class="p">,</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>            <span class="s2">&quot;Mean Absolute Error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="s2">&quot;MSE&quot;</span><span class="p">,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="s2">&quot;Mean Squared Log Error&quot;</span><span class="p">,</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="s2">&quot;r squared&quot;</span><span class="p">,</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="p">]</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_metrics</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_labels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.RegressionModel.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setup the provided dataset and params for ML.</p>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="c1"># These are all not populated till a method is called later.</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="c1"># Train-test splitting and scaling.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>    <span class="n">df_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>    <span class="n">x_array</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>    <span class="n">y_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Target&quot;</span><span class="p">]</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_eval</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="n">x_array</span><span class="p">,</span> <span class="n">y_classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_split_ratio</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="n">train_data_scaled</span><span class="p">,</span> <span class="n">eval_data_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supervised_scale_features</span><span class="p">(</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="n">scaling_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_method</span><span class="p">,</span> <span class="n">x_array_train</span><span class="o">=</span><span class="n">x_array_train</span><span class="p">,</span> <span class="n">x_array_eval</span><span class="o">=</span><span class="n">x_array_eval</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="p">)</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;train_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data_scaled</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eval_data_scaled</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_train&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_eval</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="c1"># Define ML Pipeline:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_approach</span> <span class="o">=</span> <span class="n">RepeatedKFold</span><span class="p">(</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_splits</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_validation_repeats</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="p">)</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_model_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_model_params</span><span class="p">(</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">models_to_use</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">models_to_use</span><span class="p">,</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">available_models</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">,</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">search_approach</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">search_approach</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="n">is_classification</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>    <span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.RegressionModel.evaluate_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate_models</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Evaluates each ML model's performance on the validation data set
and provides the user with a summary of the results.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe with each row a containing several regression metrics
for each ML model generated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    Evaluates each ML model&#39;s performance on the validation data set</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    and provides the user with a summary of the results.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    pd.DataFrame</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">        Dataframe with each row a containing several regression metrics</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        for each ML model generated.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">all_regression_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">y_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;y_eval&quot;</span><span class="p">]</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="n">yhat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_datasets</span><span class="p">[</span><span class="s2">&quot;eval_data_scaled&quot;</span><span class="p">])</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">regression_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regression_metrics</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">y_true</span><span class="o">=</span><span class="n">y_validation</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">yhat</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">all_regression_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">regression_df</span><span class="p">)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_regression_dfs</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="key_interactions_finder.model_building.UnsupervisedModel" class="doc doc-heading">
            <code>UnsupervisedModel</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="key_interactions_finder.model_building._MachineLearnModel">_MachineLearnModel</span></code></p>


        <p>Class to construct machine learning models for when there is
no target class available (aka, unsupervised learning).</p>
<p>At present there is limited support for this, with only
principal component analysis (PCA) available.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.UnsupervisedModel.dataset">dataset</span></code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.UnsupervisedModel.out_dir">out_dir</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path to store results files to.
Default = ""</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.UnsupervisedModel.feat_names">feat_names</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All feature names/labels.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.UnsupervisedModel.data_scaled">data_scaled</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input dataset scaled with Standard scaling.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="key_interactions_finder.model_building.UnsupervisedModel.ml_models">ml_models</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keys are the model name/method and values are the instance of the
built model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="describe_ml_planned() (key_interactions_finder.model_building.UnsupervisedModel.describe_ml_planned)" href="#key_interactions_finder.model_building.UnsupervisedModel.describe_ml_planned">describe_ml_planned</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Prints a summary of what machine learning protocol has been selected.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="build_models(save_models=True) (key_interactions_finder.model_building.UnsupervisedModel.build_models)" href="#key_interactions_finder.model_building.UnsupervisedModel.build_models">build_models</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Runs the machine learning and summarizes the results.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="k">class</span><span class="w"> </span><span class="nc">UnsupervisedModel</span><span class="p">(</span><span class="n">_MachineLearnModel</span><span class="p">):</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">    Class to construct machine learning models for when there is</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">    no target class available (aka, unsupervised learning).</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    At present there is limited support for this, with only</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    principal component analysis (PCA) available.</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">    dataset : pd.DataFrame</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        Input dataset.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">    out_dir : str</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">        Directory path to store results files to.</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">        Default = &quot;&quot;</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    feat_names : np.ndarray</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">        All feature names/labels.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    data_scaled : np.ndarray</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        Input dataset scaled with Standard scaling.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    ml_models : dict</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        Keys are the model name/method and values are the instance of the</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        built model.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">    Methods</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">    -------</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">    describe_ml_planned()</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        Prints a summary of what machine learning protocol has been selected.</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">    build_models(save_models)</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        Runs the machine learning and summarizes the results.</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="n">dataset</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="n">out_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="c1"># Dynamically generated:</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="n">feat_names</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="n">data_scaled</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="n">ml_models</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="c1"># This is called at the end of the dataclass&#39;s initialization procedure.</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="c1"># Allow a user with a supervised dataset to do unsupervised learning.</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Target&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">describe_ml_planned</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints a summary of what machine learning protocol has been selected.&quot;&quot;&quot;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>        <span class="n">out_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;Below is a summary of the unsupervised machine learning you have planned. </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;You will use </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> features to build the model, with &quot;</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;all of your data will be used for training the model, &quot;</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;which is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;Currently you will use principal component analysis to get your results. &quot;</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;More methods might be added in the future. &quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;If you&#39;re happy with the above, lets get model building!&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="k">return</span> <span class="n">out_text</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_models</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        Runs the machine learning and summarizes the results.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        save_models : bool</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            Whether to save the ML models made to disk.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            Default is True.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>        <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_scaled</span><span class="p">)</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="p">[</span><span class="s2">&quot;PCA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All models built.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="k">if</span> <span class="n">save_models</span><span class="p">:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>            <span class="n">temp_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;temporary_files&quot;</span><span class="p">)</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">temp_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>                <span class="n">Path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="n">feat_names_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="s2">&quot;feature_names.npy&quot;</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">feat_names_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span><span class="p">)</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="n">model_out_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="s2">&quot;PCA_Model.pickle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_save_best_models</span><span class="p">(</span><span class="n">best_model</span><span class="o">=</span><span class="n">pca</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="n">model_out_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.UnsupervisedModel.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setup the provided dataset and params for ML.</p>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup the provided dataset and params for ML.&quot;&quot;&quot;</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">_prep_out_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_dir</span><span class="p">)</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="c1"># Allow a user with a supervised dataset to do unsupervised learning.</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>    <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Target&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>    <span class="n">data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">describe_ml_planned</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.UnsupervisedModel.build_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_models</span><span class="p">(</span><span class="n">save_models</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Runs the machine learning and summarizes the results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>save_models</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to save the ML models made to disk.
Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_models</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    Runs the machine learning and summarizes the results.</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">    save_models : bool</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        Whether to save the ML models made to disk.</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        Default is True.</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_scaled</span><span class="p">)</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ml_models</span><span class="p">[</span><span class="s2">&quot;PCA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All models built.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="k">if</span> <span class="n">save_models</span><span class="p">:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="n">temp_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;temporary_files&quot;</span><span class="p">)</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">temp_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="n">Path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">feat_names_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="s2">&quot;feature_names.npy&quot;</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">feat_names_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feat_names</span><span class="p">)</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="n">model_out_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="s2">&quot;PCA_Model.pickle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_best_models</span><span class="p">(</span><span class="n">best_model</span><span class="o">=</span><span class="n">pca</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="n">model_out_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="key_interactions_finder.model_building.UnsupervisedModel.describe_ml_planned" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">describe_ml_planned</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prints a summary of what machine learning protocol has been selected.</p>


            <details class="quote">
              <summary>Source code in <code>key_interactions_finder/model_building.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="k">def</span><span class="w"> </span><span class="nf">describe_ml_planned</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints a summary of what machine learning protocol has been selected.&quot;&quot;&quot;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>    <span class="n">out_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;Below is a summary of the unsupervised machine learning you have planned. </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;You will use </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> features to build the model, with &quot;</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;all of your data will be used for training the model, &quot;</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;which is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;Currently you will use principal component analysis to get your results. &quot;</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;More methods might be added in the future. &quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>    <span class="n">out_text</span> <span class="o">+=</span> <span class="s2">&quot;If you&#39;re happy with the above, lets get model building!&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>    <span class="k">return</span> <span class="n">out_text</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.tabs.link", "content.code.annotate", "content.code.copy", "navigation.instant", "navigation.sections", "navigation.top", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>